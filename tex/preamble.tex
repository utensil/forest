% From my print.tex

\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{newpxtext,newpxmath}

% Extra stuff for Forester
\newcommand{\texstrip}{}
\usepackage{mathtools, stmaryrd}

% https://www.overleaf.com/learn/latex/Indices
% https://tex.stackexchange.com/a/58236/75671
\usepackage{imakeidx}
\makeindex[columns=3, title=Alphabetical Index, intoc]

% https://www.overleaf.com/learn/latex/Typesetting_quotations
\usepackage{csquotes}

% https://tex.stackexchange.com/questions/383054/biblatex-error-incompatible-backref-package
% \usepackage[backend=biber]{biblatex}

% avoid package load order conflicts etc.
% otherwise with only
% \usepackage[subpreambles=true]{standalone}
% we have errors like:
% (/usr/local/texlive/2024/texmf-dist/tex/latex/spath3/tikzlibraryspath3.code.tex
% (/usr/local/texlive/2024/texmf-dist/tex/latex/spath3/spath3.sty)))
% (../tex/string-diagrams.tex
% (/usr/local/texlive/2024/texmf-dist/tex/latex/string-diagrams/string-diagrams.s
% ty)) (../tex/diagrams.tex

% ! LaTeX Error: Command \dontworryaboutit already defined.
%                Or name \end... illegal, see p.192 of the manual.
\usepackage[mode=tex,subpreambles=true]{standalone}
% \usepackage[mode=tex,subpreambles=true,print,sort]{standalone}

% \setcounter{tocdepth}{5}
% \setcounter{secnumdepth}{5}

% https://www.overleaf.com/learn/latex/Articles%2FHow_to_change_paragraph_spacing_in_LaTeX#Understanding_\baselinestretch_and_\linespread
% \renewcommand{\baselinestretch}{1.2}\selectfont
\linespread{1.1}

% https://www.overleaf.com/learn/latex/Articles%2FHow_to_change_paragraph_spacing_in_LaTeX#The_parskip_package
\setlength{\parskip}{3ex plus 0.5ex minus 0.2ex}
\setlength{\parindent}{0cm}
% \usepackage[skip=3.3ex]{parskip}

% https://tex.stackexchange.com/a/364574/75671
\newcommand{\subsubsubsection}[1]{\paragraph{#1}\mbox{}\\}
% \setcounter{secnumdepth}{4}
% \setcounter{tocdepth}{4}

% https://tex.stackexchange.com/a/119229/75671
% \newlength{\mytextsize}
% \makeatletter
% \setlength{\mytextsize}{\f@size pt}

% From my preamble/common.tex
\usepackage[svgnames,dvipsnames]{xcolor}
% \PassOptionsToPackage{usenames,svgnames,dvipsnames}{xcolor}
% \usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{graphicx}
\DeclareGraphicsExtensions{.svg,.png,.jpg}
% \usepackage{tikz}
% \usepackage{tikz-cd}
% \usetikzlibrary{shapes,arrows,decorations}
% \usepackage{color} 
% \PassOptionsToPackage{hyphens}{url}
% \usepackage[unicode]{hyperref}
\usepackage[unicode,pagebackref=true,bookmarksopen=true, bookmarksdepth=5]{hyperref}
\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}
\hypersetup{
    bookmarksnumbered=true,     
    bookmarksopen=true,         
    bookmarksopenlevel=1, 
    pdfpagemode=UseOutlines
}
\usepackage{cleveref}

% NOTE: Won't work in web version for roman numerals, but it works well for PDF version
\usepackage{enumerate}% http://ctan.org/pkg/enumerate

\date{\today}

% From my preamble/print.tex

\hyphenpenalty=750

\hypersetup{%
  colorlinks=true,
  linkcolor={red!50!black},
  citecolor={green!50!black},
  urlcolor={blue!80!black}
}

\usepackage[utf8]{inputenc}

\usepackage{microtype}

\usepackage{xspace}
\usepackage{xpatch}

\usepackage{newunicodechar}

\usepackage{float} %figure inside minipage
\usepackage[autosize,debug]{dot2texi}


\usepackage{backref}
% Back refs
\renewcommand*{\backrefalt}[4]{%
    \ifcase #1 \footnotesize{(Not cited.)}%
    \or        \footnotesize{(Cited on page~#2)}%
    \else      \footnotesize{(Cited on pages~#2)}%
    \fi}

% theorem styles are implemented by package `mdframed` for LaTeX i.e. PDF
% mostly follows https://github.com/vEnhance/napkin/blob/main/tex/preamble.tex
\usepackage{thmtools}
\usepackage[framemethod=TikZ]{mdframed}

\theoremstyle{definition}
\mdfdefinestyle{mdbluebox}{%
	% roundcorner = 10pt,
	% linewidth=1pt,
	% skipabove=4ex,
	% innertopmargin=4ex,
	% innerbottommargin=9pt,
	% skipbelow=2pt,
	% innermargin=2em,
	% % nobreak=true,
	% needspace=20em,
	% usetwoside=false,
	% linecolor=blue,
	% backgroundcolor=TealBlue!5,
	skipabove=4ex,
	linewidth=2pt,
	rightline=false,
	leftline=true,
	topline=false,
	bottomline=false,
	innermargin=2em,
	% nobreak=true,
	needspace=20em,
	linecolor=MidnightBlue,
	backgroundcolor=TealBlue!5,
	usetwoside=false,
	% innerleftmargin=20pt,
}
\declaretheoremstyle[
	spaceabove=12pt,
	spacebelow=1pt,
	headfont=\sffamily\bfseries\color{MidnightBlue!70!black},
	mdframed={style=mdbluebox},
	headpunct={\\[3pt]}
]{thmbluebox}

\mdfdefinestyle{mdredbox}{%
	linewidth=0.5pt,
	skipabove=4ex,
	frametitleaboveskip=5pt,
	frametitlebelowskip=0pt,
	skipbelow=2pt,
	frametitlefont=\bfseries,
	innertopmargin=4ex,
	innerbottommargin=8pt,
	innermargin=2em,
	% tt-002B is too tall
	% nobreak=true,
	needspace=20em,
	linecolor=RawSienna,
	backgroundcolor=Salmon!5,
	usetwoside=false,
}
\declaretheoremstyle[
	headfont=\bfseries\color{RawSienna},
	mdframed={style=mdredbox},
	headpunct={\\[3pt]},
	postheadspace={0pt},
]{thmredbox}

\mdfdefinestyle{mdgreenbox}{%
	skipabove=4ex,
	linewidth=2pt,
	rightline=false,
	leftline=true,
	topline=false,
	bottomline=false,
	innermargin=2em,
	% nobreak=true,
	needspace=20em,
	linecolor=ForestGreen,
	backgroundcolor=ForestGreen!5,
	usetwoside=false,
	% innerleftmargin=20pt,
}
\declaretheoremstyle[
	headfont=\bfseries\sffamily\color{ForestGreen!70!black},
	bodyfont=\normalfont,
	% spaceabove=2pt,
	spaceabove=12pt,
	spacebelow=1pt,
	mdframed={style=mdgreenbox},
	headpunct={\\[3pt]},
]{thmgreenbox}
\declaretheoremstyle[
	headfont=\bfseries\sffamily\color{ForestGreen!70!black},
	bodyfont=\normalfont,
	spaceabove=12pt,
	spacebelow=1pt,
	mdframed={style=mdgreenbox},
	headpunct={\\[3pt]},
]{thmgreenbox*}

\mdfdefinestyle{mdblackbox}{%
	skipabove=4ex,
	linewidth=3pt,
	rightline=false,
	leftline=true,
	topline=false,
	bottomline=false,
	linecolor=black,
	backgroundcolor=RedViolet!5!gray!5,
}
\declaretheoremstyle[
	headfont=\bfseries\sffamily,
	bodyfont=\normalfont\small,
	spaceabove=0pt,
	spacebelow=0pt,
	mdframed={style=mdblackbox}
]{thmblackbox}

\declaretheoremstyle[
	headfont=\bfseries\sffamily,
	bodyfont=\normalfont, %\small, %\sffamily,
	% spaceabove=0pt,
	% spacebelow=0pt,
	headpunct={\\[3pt]},
]{def}

\numberwithin{equation}{subsection}
\theoremstyle{definition}
% \declaretheorem[style=thmblackbox,name=Definition,numberwithin=subsection]{definition}
\declaretheorem[style=thmbluebox,name=Theorem,numberwithin=subsection, numberlike=equation]{theorem}
\declaretheorem[style=thmbluebox,name=Theorem,numberwithin=subsection, numberlike=equation]{theoremx} % theorem not in dep graph
\declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
\declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemmax} % lemma not in dep graph
\declaretheorem[style=thmbluebox,name=Corollary,sibling=theorem]{corollary}
\declaretheorem[style=thmbluebox,name=Proposition,sibling=theorem]{proposition}

\theoremstyle{definition}
% \newtheorem{claim}[theorem]{Claim}
% \newtheorem{definition}[theorem]{Definition}
\declaretheorem[style=def,name=Definition,sibling=theorem]{definition}
\declaretheorem[style=def,name=Convention,sibling=theorem]{convention}
\declaretheorem[style=def,name=Notation,sibling=theorem]{notation}
% \newtheorem{fact}[theorem]{Fact}
% \newtheorem{abuse}[theorem]{Abuse of Notation}

\declaretheorem[style=thmredbox,name=Example,sibling=theorem]{example}

\theoremstyle{theorem}
% \declaretheorem[name=Question,sibling=theorem,style=thmblackbox]{ques}
% \declaretheorem[name=Exercise,sibling=theorem,style=thmblackbox]{exercise}
\declaretheorem[name=Remark,sibling=theorem,style=thmgreenbox]{remark}
\declaretheorem[name=Remark,sibling=theorem,style=thmgreenbox*]{remark*}
% \declaretheorem[name=Step,style=thmgreenbox]{step} % only used in Lebesgue int

% From my macros.tex

%%fakesection Special markers

\newcommand{\newvocab}[1]{\textbf{\color{MidnightBlue} #1}}
\newcommand{\vocab}[1]{\textbf{#1}}

%%fakesection Math symbols

\newcommand{\CC}{\mathbb C}
\newcommand{\FF}{\mathbb F}
\newcommand{\NN}{\mathbb N}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\ZZ}{\mathbb Z}

\def\Cl{\mathop{\mathcal{C}\ell}}
\def\Ga{\mathop{\mathcal{G}}}

\newcommand{\lmap}[1]{\to_{l[#1]}}
\newcommand{\rmap}{\to_{+*}}
\newcommand{\amap}{\to_{a}}
\newcommand{\lfun}{\iota}
\newcommand{\rfun}{\mathit{1}} %{\iota_{0}}
\newcommand{\afun}{\iota_{a}}

\newcommand{\Mathlib}{\textsf{Mathlib}~}
\newcommand{\MathlibDoc}[1]{\href{https://leanprover-community.github.io/mathlib4_docs/find/\#docs/#1}{#1}}

\newcommand{\bu}{\bullet}
\newcommand{\ii}{\item}
\newcommand\placeholder[1]{\texttt{#1}}
\newcommand\optional[1]{{\color{Grey} #1}}

\newcommand\pre{\mathtt{pre}}

%% Category Theory macros
\renewcommand{\AA}{\mathcal A}
\newcommand{\BB}{\mathcal B}
\newcommand{\C}{\mathcal C}
\newcommand{\obj}{\operatorname{obj}}
\newcommand{\op}{^{\mathrm{op}}}
\newcommand{\id}{\mathrm{id}}
\DeclareMathOperator{\dom}{dom} % domain
\DeclareMathOperator{\ran}{ran} % range
\DeclareMathOperator{\Hom}{Hom} % homomorphism
\DeclareMathOperator{\End}{End} % endomorphism

\input{../tex/code}